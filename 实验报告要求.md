
## 实验报告要求
1. 对于实验报告中各类型内容及格式，做如下要求：
  - 1）Verilog模块代码：主要展示自行编写的模块，或模块中的自行编写的内容，以及与实验设置相关部分代码内容，不要大段粘贴无关代码片段。文本格式，模块端口信号与关键中间变量应做注释说明，代码应有简要注释、文字说明或以其他方式辅助描述。
  - 2）仿真激励文件/指令存储器内容：文本格式，仅需给出激励信号设置部分内容，即initial块中的内容；指令存储器需给出仿真指令序列，给出对应汇编指令。测试内容需添加注释，说明测试目标，预期取值等。
  - 3）仿真波形截图：波形截图需包含信号名、信号取值与波形变化。信号名称、取值与波形变化清晰可见，信号原则上以16进制方式展示。对于状态变化较多的仿真波形，可以分多张图分段截取。
  - 4）实验结果分析说明：以文字描述为主，清晰明了，对仿真波形的分析需结合激励文件或指令存储器中的指令序列，也可在仿真波形中做相应标注或以其他形式描述。
  - 注：为配合分析说明，可自行调整波形仿真界面，展示中间变量或寄存器数值，也可修改寄存器类型变量初始值，但需文字说明。
2. 实验报告格式整洁，语言通畅，图片清晰，报告图片使用截屏软件截取，避免使用手机拍照。
3. 实验报告内容按课程内容组织，课后作业内容成单独章节，放在实验报告最后部分。所有实验报告内容撰写在一个文档中，pdf格式保存。
4. 实验报告独立完成，不得抄袭。
 
## 实验报告内容：

### 一、Verilog HDL语法实践（总计14分）
1. 多路选择器（6分）
- 1）1位2选1多路选择器（2分）
- 2）32位2选1多路选择器（2分）
- 3）32位4选1多路选择器（2分）
每部分内容需包含代码设计与仿真分析两个部分（各1分）。
2. ALU的设计与实现（8分）
- 1）代码（2分）
- 2）激励文件（1分）
- 3）仿真波形（1分）
- 4）结果分析（4分）

### 二、单周期CPU的设计与实现（总计14分）
1. 单周期CPU设计与仿真（14分）
- 1）代码（4分）
- 2）设计指令序列（4分）
- 3）设计指令序列仿真波形（2分） 
- 4）设计指令序列结果分析（4分）

### 三、流水线CPU的设计与实现（总计14分）
1. 流水段功能逻辑设计与实现（10分）
- 1）IF流水段（2分）
- 2）ID流水段（2分）
- 3）EX流水段（2分）
- 4）MEM流水段（2分）
- 5）WR流水段（2分）
- 每部分内容需包含代码设计与仿真分析两个部分（各1分）。
2. 流水线CPU仿真分析（4分）

### 四、流水线冒险及处理-数据冒险（总计14分）
1. 普通数据冒险问题处理（7分）
- 1）数据前推通路关键代码段及文字说明（2分）
- 2）仿真指令序列（1分）
- 3）仿真波形（1分）
- 4）结果分析（3分）
2. load-use数据冒险问题处理（7分）
- 1）流水线关键代码段及文字说明（2分）
- 2）仿真指令序列（1分）
- 3）仿真波形（1分）
- 4）结果分析（3分）

### 五、流水线冒险及处理-控制冒险（总计14分）
1. 控制数据冒险问题处理（14分）
- 1）修改关键代码段及文字说明（4分）
- 2）仿真指令序列（2分）
- 3）仿真波形（2分）
- 4）结果分析（6分）

### 六、课后作业（共4题，总计30分）
1. 实验1“课后作业4” （6分）
复习MIPS指令集格式，将以下MIPS汇编指令翻译为32位机器码（16进制表示），分析其执行过程与执行结果。
```mips
	PC:0x00			nop
	PC: 0x04			lw $31, 0($0) 
	PC: 0x08			sub $30, $0, $31
	PC: 0x0c 			add $29, $16, $31
	PC: 0x10 			sub $28, $0, $29
	PC: 0x14 			add $27, $16, $28
	PC: 0x18			subu $26, $31, $1
	PC: 0x1c			slt $25, $1, $31
	PC: 0x20			sltu $24, $1, $31
	PC: 0x24			addiu $23, $0, 0xab00
	PC: 0x28			addiu $22, $0, 0x00cd
	PC: 0x2c			ori $21, $22, 0xab00
	PC: 0x30			sw $21, 32($0)
	PC:0x34			beq $21, $20, 0x0003
	PC: 0x38			lw $20, 31($0) 
	PC: 0x3c			beq $21, $20, 0x0003
	PC: 0x40 			add $19, $18, $17
	PC: 0x44 			sub $18, $17, $16
	PC: 0x48 			subu $17, $16, $15
	PC: 0x4c			j 15
```
寄存器与存储器初始化如下：
```verilog
 	for (i = 0; i < 32; i = i + 1) RegFiles[i] = i;
	for (i = 0; i < 32; i = i + 1) RAM[i] = 32'h80000000 + i;
```
- 1）32位机器码表示（2分）
- 2）过程分析（2分）
- 3）执行结果（2分）

2. 实验2“课后作业1”：（6分）
将实验1“课后作业4”中的指令序列写入指令存储器InstROM并进行仿真分析。结合程序计数器PC、寄存器组RegFiles与数据存储器DataRAM中的内容验证指令执行结果。
- 1）仿真波形（2分）
- 2）结果分析（4分）

3. 实验3“课后作业3”：（8分）
第1与第4条指令间的冒险问题如何处理最简单？尝试对已实现的流水线处理器结构进行修改，解决第1、第4条指令间的冒险问题，并进行仿真验证。
```verilog
1: add $1, $2, $3;
2: sub $4, $1, $3;
3: subu, $8, $1, $9;
4: ori $6, $1, 0x800a;
5: slt $3, $1, $5;
```
- 1）修改关键代码段及文字说明（2分）
- 2）仿真波形（2分）
- 3）结果分析（4分）

3. 实验4“课后作业1”：（10分）
参考数据转发解决数据冒险的思路，思考如何修改流水线硬件结构，以解决下列指令序列中的数据冒险问题。
1: add $1, $2, $3;
2: sw $1, 0($2);
